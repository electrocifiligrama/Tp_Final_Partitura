<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Performance Evaluation of Pitch Detection Algorithms</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="author" content="Hind">
  <meta name="category" content="business">
  <meta name="keywords" content="">
  <link rel="stylesheet" href="vzhled/freestyle.css" type="text/css">
  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
  <meta name="DC.Title" content="Access Server" />
  <meta name="DC.Creator" content="České vysoké učení technické v Praze. Katedra telekomunikační techniky" />
  <meta name="DC.Subject" scheme="PHNK" content="telekomunikace" />
  <meta name="DC.Subject" scheme="PHNK" content="telekomunikační sítě" />
  <meta name="DC.Subject" scheme="PHNK" content="telekomunikační zařízení" />
  <meta name="DC.Subject" scheme="MDT_MRF" content="621.39" />
  <meta name="DC.Subject" scheme="MDT_MRF" content="(0.034.2:051)" />
  <meta name="DC.Subject" scheme="MDT_KON" content="621.39 Sdělovací technika" />
  <meta name="DC.Subject" scheme="DDC_CON" content="621.382 Communication engineering" />
  <meta name="DC.Description.abstract" content="Výsledky výzkumu a další informace nejen z oblasti přístupových telekomunikačních sítí." />
  <meta name="DC.Publisher" content="České vysoké učení technické v Praze. Katedra telekomunikační techniky" />
  <meta name="DC.Date.available" scheme="W3C-DTF" content="2004-01-01" />
  <meta name="DC.Type" scheme="DCMIType" content="Text" />
  <meta name="DC.Type" scheme="PHNK" content="elektronické časopisy" />
  <meta name="DC.Format" scheme="IMT" content="text/html" />
  <meta name="DC.Format.medium" content="computerFile" />
  <meta name="DC.Identifier" content="http://access.feld.cvut.cz/" />
  <meta name="DC.Identifier" scheme="ISSN" content="1214-9675" />
  <meta name="DC.Language" scheme="RFC3066" content="cze" />
  <meta name="google-site-verification" content="MC96Qyk9oq58scJaiPejsC8zsEOU4lKms4-AWrtm3MA" />
</head>
<body>

<div class="zahlavi">
<table align="center">
<tr class="z">
<td width="40%" align="center">
	<table style="word-spacing: 0; text-indent: 0; margin: 0">
	<tr>
		<td valign="bottom"><a href="http://access.feld.cvut.cz/view.php?nazevclanku=about-server-and-editorial-board-instructions-for-authors-and-reviewers&cisloclanku=2008040001"><img border="0" src="Vzhled/uk_flag.jpg" width="24" height="15"></a>&nbsp;&nbsp;&nbsp;</td>
		<td valign="middle"><font size="1">Výsledky výzkumu a další informace nejen<br>z oblasti přístupových telekomunikačních sítí.</font></td>
	</tr>
	</table>
</td>
<td valign="middle"><img src="vzhled/access_logo.jpg" border="0" width="200" height="50" Alt="Access server" hspace="10" /></td>
<td valign="middle"></td>
<td width="45%" align="center"><b>ISSN 1214-9675</b><br><font size="1">Server vznikl za podpory <a target=_blank href="http://www.gacr.cz">Grantové agentury ČR</a>.</font><font size="1"><br>17. ročník</font></td>
</tr>
</table>
</div>

<form action="search.php" method="post" style="word-spacing: 0; text-indent: 0; margin: 0">
<table width="100%" border="0" cellpadding="2" cellspacing="0" class="horni-navig-lista">
<tr>
<td align="left" width="210">Dnešní datum: 27. 05. 2019&nbsp;</td>
<td align="center"><a href="index.php">Hlavní stránka</a> | <a href="index.php?akce=temata">Seznam rubrik</a> | <a href="download.php">Ke stažení</a> | <a href="index.php?akce=linky">Odkazy</a></td>
<td align="right" valign="middle">&nbsp;</td>
</tr>
</table>
</form>

<table width="100%" border="0">
<tr>
<td align="center" valign="top" width="180" bgcolor="#ffff99"><!-- start - blok -->
<div class="blok-cely">
<div class="blok-hlava">Témata</div>
<div class="blok-telo"><ul style="margin-left: 14px; margin-top: 0px; margin-bottom: 0px; padding-left: 2px; list-style-image: url('./vzhled/minus.gif');">
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=24"> Řešené projekty</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=38">Akce, semináře, konference</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=42">Aktuality, úvahy, komentáře</a></li>
<li style="margin-left: 0px; list-style-image: url('./vzhled/plus.gif');"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=15&amp;stromhlmenu=15">Aplikace, sítě a služby</a></li>
<li style="margin-left: 0px; list-style-image: url('./vzhled/plus.gif');"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=10&amp;stromhlmenu=10">Bezdrátový přenos</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=28">CATV a IPTV</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=17">Digitální zpracování signálu</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=16">Distanční vzdělávání</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=46">Elektromagnetická kompatibilita</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=43">Elektronika a audio</a></li>
<li style="margin-left: 0px; list-style-image: url('./vzhled/plus.gif');"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=13&amp;stromhlmenu=13">Metalické vedení</a></li>
<li style="margin-left: 0px; list-style-image: url('./vzhled/plus.gif');"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=11&amp;stromhlmenu=11">Optické sítě</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=37">PLC</a></li>
<li style="margin-left: 0px;"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=47">Teoretická východiska</a></li>
<li style="margin-left: 0px; list-style-image: url('./vzhled/plus.gif');"><a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=14&amp;stromhlmenu=14">xDSL</a></li>
</ul>
</div>
</div>
<!-- konec - blok -->
<br />
<!-- start - blok -->
<div class="blok-cely">
<div class="blok-hlava">Doporučujeme</div>
<div class="blok-telo"><a href="http://access.fel.cvut.cz/view.php?cisloclanku=2014040001"> Knihu o FTTx</a>
<br><br>
<a href="http://matlab.feld.cvut.cz">Matlab server</a> - on-line výpočty a simulace
<br><br>
<a href="http://moodle.kme.fel.cvut.cz" rel="nofollow">E-learning</a> - on-line kurzy

</div>
</div>
<!-- konec - blok -->
<br />
<!-- start - blok -->
<div class="blok-cely">
<div class="blok-hlava">Kontakt</div>
<div class="blok-telo"><a href="http://www.comtel.cz" rel="nofollow">KTT</a> FEL ČVUT 
<br> <a href="mailto: pravdai@fel.cvut.cz">Napište nám</a> 
<br><br>
<a href="http://access.feld.cvut.cz/view.php?cisloclanku=2007100001">Redakční rada</a> - pokyny pro autory a recenzenty
<br><br>
<a href="http://access.feld.cvut.cz/view.php?cisloclanku=2007110002">Copyright</a>

</div>
</div>
<!-- konec - blok -->
<br />
</td>
<td valign="top"><div class="premodryram">
<div class="z">
<a href="search.php?rsvelikost=sab&amp;rstext=all-phpRS-all&amp;rstema=17"><img src="image/topic/logo_dsp.gif" border="0" align="right" alt="Digitální zpracování signálu" /></a>
<h1 class="cla-nadpis"><img src="vzhled/bullet.gif" border="0" hspace="3" alt="*" /> Performance Evaluation of Pitch Detection Algorithms</h1>
<span class="cla-informace">Vydáno dne 02. 06. 2009 (37680 přečtení)</span><br /><br />
<div class="cla-text">	<i>This paper presents the comparative study of performance of four pitch 
	detection algorithms. The algorithms have been 
	evaluated with a speech database, consisting of utterances spoken in Czech 
	language by five males and five females. The set of measurements was made on 
	speech signals to quantify various types of errors, which occur in each of 
	the above pitch detection algorithms.</i> <br /><br /><hr>
<h5>Porovnání výkonnosti algoritmů detekce základního tónu řeči</h5>
<p align="justify">
<i>
Článek pojednává o porovnávací studii výkonnosti čtyř algoritmů detekce základního tónu. Algoritmy představené ve studii jsou následující: autokorelační metoda upravená technikou centrálního klipování, metoda založená na normované krosskorelační funkci, metoda založená na funkci střední odchylky amplitud a kepstralní metoda. Pro porovnání algoritmů byla použita databáze řečových signálů, která se skládá z promluv 5 mužů a 5 žen v českém jazyce. Výkonnost algoritmů byla vyhodnocena pomoci různých typů chyb, vznikajících při detekci základního tónu výše zmíněnými algoritmy.
</i>
</p>
<p align="justify">
<i>Klíčová slova (Keywords): algoritmy detekce základního tónu; výkonnost algoritmů; autokorelační metoda; metoda krosskorelační funkce; metoda střední odchylky amplitud; kepstralní metoda
</i>
</p>
<hr>
<h3>1. Introduction</h3>
<p class="MsoNormal" style="text-align: justify"><span lang="EN-US">Speech 
coding is a fundamental element in digital communications. It has progressed in 
parallel to the increase of telecommunication services demand. The development 
of good quality low bit-rate speech codecs has been an objective for the 
substantial amount of research [1]. A primary underlying task in this area is 
the extraction of features from speech signals, which can be used for speech 
synthesis applications. One of the important features is fundamental frequency, 
more commonly referred to as pitch. In this paper, the terms pitch and its 
primary acoustical correlate fundamental frequency are used interchangeably. 
Fundamental frequency (F<sub>0</sub>) corresponds to the rate at which the human 
vocal cords vibrate. A pitch detector is an essential component in a variety of 
speech processing systems. Besides providing necessary information about the 
nature of the excitation source for speech coding, the pitch contour of an 
utterance is useful for recognizing speakers, determination of their emotion 
state, for voice activity detection task, and many others applications [2]. 
Various pitch detection algorithms (PDAs) have been developed in the past: 
autocorrelation method [1], HPS [2], RAPT [3], AMDF method [4], CPD [5], SIFT 
[6], DFE [7]. Most of them have very high accuracy for voiced pitch estimation, but the 
error rate considering voicing decision is still quite high. Moreover, the PDAs 
performance degrades significantly as the signal conditions deteriorate [8]</span>.
<span lang="EN-US">Pitch detection algorithms can be classified into the 
following basic categories: time-domain based tracking, frequency domain based 
tracking or joint time-frequency domain based tracking. In this paper, the 
principles of four PDAs including preprocessing and extraction of pitch pattern 
techniques are summarized. The implementation of them is described. Some 
experiments and discussions are presented.</span></p>
<h3>2. <span lang="EN-US">Pitch detection algorithms</span></h3>

<p align="justify">
	&nbsp;<b>2.1 <i>Modified Autocorrelation Function (MACF) Method</i></b><p class="MsoNormal" style="text-align:justify">
The autocorrelation approach is the most widely used time domain method for 
estimating pitch period of a speech signal [2]. This method 
is based on detecting the highest value of the autocorrelation function in the 
region of interest. For given discrete signal x(n), the autocorrelation 
function is generally defined<span lang="EN-US" style="font-family:&quot;Times New Roman&quot;"> 
</span></p>
	<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021309_111.png" width="356" height="51" alt="Form1" title="Form1" /></div></td>
			<td width="100" align="right"><font size="2">(1)</font></td>
		</tr>
	</table>

<p align="justify">
	&nbsp;<span lang="EN-US">where <i>N </i>is the length of analyzed sequence 
	and <i>M<sub>0</sub> </i>is the number of autocorrelation points to be 
	computed. For pitch detection, if we assume that <i>x(n) </i>is periodic 
	sequence, <i>x(n)=x(n+P) </i>for all<i> n, </i>it is shown that the 
	autocorrelation function is also periodic with the same period, <i>R(m)=R(m+P).
	</i>Conversely, the periodicity in the autocorrelation function indicates 
	periodicity in the signal. For a non-stationary signal, such as speech, the 
	concept of a long-time autocorrelation measurement given by (1) is not 
	really meaningful. In practice, we operate with a short speech segments, 
	consisting of finite number of samples. That is why in autocorrelation based 
	PDAs short-time autocorrelation function, given by </span> 
</p>
	<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021309_112.png" width="356" height="51" alt="Form2" title="Form2" /></div></td>
			<td width="100" align="right"><font size="2">(2)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">is used. The 
variable <i>m</i> in (2) is called lag or delay, and the pitch is equal to the 
value of <i>m</i> which results in the maximum <i>R(m)</i>. The modified 
autocorrelation pitch detector MACF [6] differs from the common autocorrelation 
method by using center-clipping technique in a pre-processing stage. The 
relation between the input signal x(n), and the center-clipped signal y(n) is
</span></p>
	<table align="center" id="table1">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021309_113.png" width="318" height="113" alt="Form3" title="Form3" /></div></td>
			<td width="100" align="right"><font size="2">(3)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">where C<sub>L</sub> 
is the clipping threshold. Generally, C<sub>L</sub> is about 50% of the maximum 
absolute signal value within the signal frame. Non-linear operations on the 
speech signal such as center-clipping tend to flatten the spectrum of the signal 
passed to the candidate generator. This results in the increase of the 
distinctiveness of the true period peaks in the autocorrelation function. Figure 
1 presents the example of voiced frame, its center clipped version, and the 
difference between the autocorrelation function calculated from original signal 
frame and center-clipped signal frame.</span></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021413_Fig1a.png" width="451" height="366" alt="Fig1" title="Fig1" /></div></td>
					</tr>
	</table>
<p class="MsoNormal" align="center" style="text-align:center;text-indent:14.2pt">
<i>Figure 1: Comparison of autocorrelation function calculated from voiced frame 
and its center-clipped version.</i></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021501_Fig2a.png" width="496" height="454" alt="Fig2" title="Fig2" /></div></td>
					</tr>
	</table>

<p class="MsoNormal" align="center" style="text-align:center;text-indent:14.2pt">
<i>Figure 2: Block diagram of modified autocorrelation pitch detector.</i></p>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">Figure 2 
shows the block diagram of the modified autocorrelation pitch detection 
algorithm. At the beginning of processing speech signal must be segmented into 
overlapping frames. Speech recordings with 8kHz sampling frequency were used for 
experiments. Therefore, input speech signal must be segmented into overlapping 
frames of 240 samples (30ms), length of overlap is 160 samples (20ms). This 
method requires low-pass filtering (LPF) up to 800 Hz. Then, the autocorrelation 
function for the 30-ms section is computed over the range of lags from 16 to 160 
samples (i.e. 2ms-20ms period). This range of lags corresponds to the real 
values of the fundamental frequency of 50-500Hz. Additionally, the 
autocorrelation function at 0 delay is computed for appropriate normalization 
purposes. The normalized autocorrelation function is then searched for its 
maximum peak. The value of the peak and its position are defined. If the value 
of peak exceeds threshold, the frame is classified as voiced. Otherwise, the 
section is classified as unvoiced (Fig.3). The value of fundamental frequency 
can be computed from the pitch period by equalization F<sub>0</sub>[Hz]=1/T[s].
</span></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021424_Fig3a.png" width="471" height="366" alt="Fig3" title="Fig3" /></div></td>
					</tr>
	</table>

<p class="MsoNormal" align="center" style="text-align:center;text-indent:14.2pt">
<i>Figure 3: Process of voiced/unvoiced classification.</i></p>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">In general, 
the pitch detection described above still exhibits errors as a result of 
erroneous voiced/unvoiced decisions and inaccurate pitch estimation. 
Consequently some smoothing stage, such as median filtering is necessary to 
improve the performance of the system. A major limitation of the 
auto-correlation function is that it can contain many other peaks, other than 
those due to basic periodic components (see Fig. 2). For voiced speech signals, 
the numerous peaks are present in the auto-correlation function due to the 
damped oscillations of the vocal tract response. It is difficult for any simple 
peak picking process to discriminate peaks, which doesn’t correspond to the real 
pitch period, due to periodicity of these extraneous peaks. The peak selection 
is more robust, if some preprocessing techniques or a relatively large time 
window are used. However, using of large time window results in improper 
tracking of rapid changes in pitch. In spite of some peak picking problems, the 
autocorrelation performs well in the majority of cases and is relatively noise 
immune [2].</span></p>
<p align="justify">
	<i><b>&nbsp;2.2 
	Normalized Cross Correlation Function (NCCF) Method</b></i><p class="MsoNormal" style="text-align:justify"><span lang="EN-US">The 
normalized cross correlation function (NCCF) is very similar to the 
autocorrelation function, but is better follows the rapid changes in pitch and 
the amplitude of speech signal [3]. The NCCF based PDA overcomes most of the 
shortcomings of the autocorrelation based algorithms at a slight increase in 
computational complexity.The NCCF function for speech segment <i>x(n)</i>, <i>0 
&#8804; n &#8804; N-1</i> is defined</span></p>
	<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021309_114.png" width="389" height="104" alt="Form4" title="Form4" /></div></td>
			<td width="100" align="right"><font size="2">(4)</font></td>
		</tr>
	</table>

<p class="MsoNormal">
	where N is 
	the length of analyzed frame, m is a lag and M0 is the number of autocorrelation points to be computed.It should be 
	noted that the values of NCCF function always lie in the interval [-1, 1]. 
	The values of NCCF tends to be close to 1 for lags corresponding to the 
	integer multiples of the true pitch period, regardless of the rapid changes 
	in amplitude of x(n) (Fig. 4). NCCF is better suited for pitch detection 
	than the normal autocorrelation function [6]. It is more frequently used in 
	pitch detection algorithms [2]. In comparison with the normal 
	autocorrelation function, the peaks corresponding to pitch period in the 
	NCCF are more prominent and less affected by the rapid variations in the 
	signal amplitude. The advantage of the NCCF over the autocorrelation method 
	is illustrated in Fig. 4.</p>
	<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021425_Fig4a.png" width="428" height="325" alt="Fig4" title="Fig4" /></div></td>
					</tr>
	</table>

<p align="center" class="MsoNormal" style="text-align: center; text-indent: 14.2pt">
	<i>Figure 4: Illustration of the autocorrelation and NCCF for a typical 
	voiced speech frame.</i></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021510_Fig5a.png" width="455" height="390" alt="Fig5" title="Fig5" /></div></td>
					</tr>
	</table>

<p align="center" class="MsoNormal" style="text-align: center; text-indent: 14.2pt">
<i>Figure 5: Block diagram of NCCF pitch detector.</i></p>
<p align="justify">
	&nbsp;<span lang="EN-US" style="color: black">The block diagram of the NCCF 
	pitch detector is shown in Fig. 5. After segmentation of speech signal into 
	overlapping frames, low-pass filtering is also required. </span>
	<span lang="EN-US">Further normalized cross-correlation function is computed 
	over a range of lags from 16 to 160 samples. The NCCF function is then 
	searched for its maximum value. The value of the peak and its position are 
	defined. Despite of the relative robustness of the NCCF for pitch detection, 
	the magnitude of the NCCF largest peak is not a reliable indicator of 
	whether the speech segment is voiced or unvoiced. A voiced/unvoiced decision 
	is made on the basis of the energy of the frames. If the speech frame is 
	classed as voiced, then the lag corresponding to the highest peak of NCCF is 
	considered to be the pitch period.&nbsp; In order to compensate the effects of 
	some errors in pitch detection and voiced/unvoiced decision median filter is 
	used. The filtering operation produces final F<sub>0</sub> estimates.</span></p>
	
<p align="justify">
	&nbsp;<b>2.3 </b><i><b>Average Magnitude Difference Function (AMDF) Method</b></i><p class="MsoNormal" style="text-align:justify"><span lang="EN-US">The average 
magnitude difference function (AMDF) [4] is another type of autocorrelation 
analysis. Instead of correlating the input speech at various delays (where 
multiplications and summations are formed at each value), a difference signal is 
formed between the delayed speech and original, and at each delay value the 
absolute magnitude is taken. For the frame of<i> N </i>samples, the short-term 
difference function AMDF is defined</span></p>
	<table align="center" id="table2">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021311_115.png" width="333" height="51" alt="Form5" title="Form5" /></div></td>
			<td width="100" align="right"><font size="2">(5)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">where <i>x(n)
</i>are the samples of analyzed speech frame, <i>x(n-m)</i> are the samples time 
shifted on <i>m</i> samples and <i>N</i> is the frame length. The difference 
function is expected to have a strong local minimum if the lag <i>m </i>is equal 
to or very close to the fundamental period. Figure 6 depicts values of AMDF 
function for voiced frame.</span></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021425_Fig6a.png" width="428" height="221" alt="Fig6" title="Fig6" /></div></td>
					</tr>
	</table>

<p class="MsoNormal" style="text-indent: 14.2pt" align="center"><i>Figure 6: 
ADMF function of voiced frame of speech</i></p>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">PDA based on 
average magnitude difference function has advantage in relatively low 
computational cost and simple implementation [2]. Unlike the autocorrelation 
function, the AMDF calculations require no multiplications. This is a desirable 
property for real-time applications. Procedure of processing operations for AMDF 
based pitch detector is quite similar to the NCCF algorithm. After segmentation, 
the signal is pre-processed to remove the effects of intensity variations and 
background noise by low-pass filtering. Then the average magnitude difference 
function is computed on speech segment at lags running from 16 to 160 samples. 
The pitch period is identified as the value of the lag at which the minimum AMDF 
occurs. In addition to the pitch estimate, the ratio between the maximum and 
minimum values of AMDF (MAX/MIN) is obtained. This measurement with the frame 
energy is used to make a voiced/unvoiced decision [6]. In transition segments 
between voiced, unvoiced or silence regions some determination errors may occur. 
Especially F<sub>0</sub> doubling or halving errors are most frequent. Therefore 
median filtering is used in AMDF based PDA.</span></p>
	
<p align="justify">
	<b><i>&nbsp;</i>2.4
	<i>Cepstrum Pitch Determination (CPD)</i></b><p class="MsoNormal" style="text-align:justify">
<span lang="EN-US">Cepstral analysis also provides a way for the pitch 
estimation. The cepstrum of voiced speech intervals has strong peak 
corresponding to the pitch period [5]. Cepstrum pitch determination technique 
has some advantages over autocorrelation based PDAs. It is assumed that the 
sequence of voiced speech <i>s(n)</i> can be presented as</span></p>
	<table align="center" id="table3">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021311_116.png" width="128" height="26" alt="Form6" title="Form6" /></div></td>
			<td width="100" align="right"><font size="2">(6)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">where <i>e(n)</i> 
is source excitation sequence and <i>h(n) </i>is the vocal tract’s discrete 
impulse response<i>. </i>In the autocorrelation function the effects of the 
vocal source and vocal tract are convolved with each other. This results in 
broad peaks and in some cases multiple peaks in the autocorrelation function. In 
frequency domain convolution relationship between vocal source and vocal tract 
effects becomes a multiplicative relationship</span></p>
	<table align="center" id="table4">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021311_117.png" width="139" height="26" alt="Form7" title="Form7" /></div></td>
			<td width="100" align="right"><font size="2">(7)</font></td>
		</tr>
	</table>
<p class="Noviparagraf" style="text-indent:0cm"><span lang="EN-US">where <i>S(</i></span><i><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;">&#969;</span><span lang="EN-US">)=F{s(n)}, 
E(</span><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;">&#969;</span><span lang="EN-US">)=F{e(n)}
</span></i><span lang="EN-US">and<i> H(</i></span><i><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;">&#969;</span><span lang="EN-US">)=F{h(n)}</span></i><span lang="EN-US">. 
Symbol <i>F </i>stands for Discrete Fourier Transform (DFT)<i>.</i> Function (7) 
then can be represented as (8), </span></p>
	<table align="center" id="table5">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021311_118.png" width="361" height="27" alt="Form8" title="Form8" /></div></td>
			<td width="100" align="right"><font size="2">(8)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">The 
multiplicative relationship between source and tract effects in cepstrum is 
transformed into an additive relationship. The effects of the vocal source and 
vocal tract are nearly independent or easily identifiable and separable. It is 
possible to separate the part of the cepstrum, which is represents source signal 
and find true pitch period. That is why, in general, cepstrum pitch 
determination is more accurate than autocorrelation PDAs [2]. For pitch 
determination, real part of the cepstrum is sufficient. The real cepstrum of the 
discrete signal s(n) is defined as</span></p>
	<table align="center" id="table6">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021312_119.png" width="197" height="60" alt="Form9" title="Form9" /></div></td>
			<td width="100" align="right"><font size="2">(9)</font></td>
		</tr>
	</table>
<p class="MsoNormal"><span lang="EN-US">where S(k) is logarithmic magnitude 
spectrum of s(n)</span></p>
	<table align="center" id="table7">
		<tr>
			<td align="center">
			<div align="center"><img src="storage/200906021312_120.png" width="190" height="60" alt="Form10" title="Form10" /></div></td>
			<td width="100" align="right"><font size="2">(10)</font></td>
		</tr>
	</table>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">The cepstrum 
consists of peak occurring at a high quefrency equal to the pitch period in 
seconds and low quefrency information corresponding to the formant structure in 
the log spectrum [5]. To obtain an estimation of the fundamental frequency from 
the cepstrum we look for a peak in the quefrency region corresponding to typical 
speech fundamental frequencies. In Figure 7 an example of fundamental frequency 
estimation from the cepstrum of voiced frame is presented.</span></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021425_Fig7a.png" width="491" height="258" alt="Fig7" title="Fig7" /></div></td>
					</tr>
	</table>

<p class="MsoNormal" align="center" style="text-indent: 14.2pt"><i>Figure 7: 
Waveform (a) and real cepstrum (b) of voiced speech segment. </i></p>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">Procedure of 
processing operations for cepstrum based pitch detector is similar to the PDAs 
described above. It should also be noted that the cepstral pitch detector uses 
the full-band speech signal for processing. Each block of 240 samples is 
weighted by a 240-point Hamming window and the cepstrum of that block is 
computed. The peak cepstral value and its location is determined. If the value 
of this peak exceeds a fixed threshold, the section is called voiced and the 
pitch period is the location of the peak. If the peak does not exceed the 
threshold, a zero-crossing count is made on the block. If the zero-crossing 
count exceeds a given threshold, the block is marked as unvoiced. Otherwise, it 
is called voiced and the period is the location of the maximum value of the 
cepstrum.</span></p>


	
<h3>3. Experiments and 
discussion</h3>

<p align="justify">
	<i><b>&nbsp;3.1 
	Experiment Settings and Evaluation Criteria</b></i><p class="MsoNormal" style="text-align:justify">
<span lang="EN-US">Our experiments evaluate performance of described PDAs. In 
the experiments we used speech signals from the Czech “SpeechDat” database of 
telephone speech. Speech recordings from the database consist of numbers from 1 
to 10 in Czech language pronounced by 5 males and 5 females. The sampling rate 
for the speech signals was 8kHz using 16-bit A/D converter. Speech recordings 
were hand-marked into voiced/unvoiced regions and individual pitch values.</span></p>
<p class="MsoNormal" style="text-align:justify"><span lang="EN-US">The accuracy 
of the different pitch detection algorithms was measured according to the 
following criteria [8]:</span></p>
<p class="MsoNormal" style="text-align:justify;text-indent:14.2pt">
<span lang="EN-US">1. Classification Error (CE): it is the percentage of 
unvoiced frames classified as voiced and voiced frames classified as unvoiced.</span></p>
<p class="MsoNormal" style="text-align:justify;text-indent:14.2pt">
<span lang="EN-US">2. Gross Error (GE): percentage of voiced frames with an 
estimated fundamental frequency value that deviates from the reference value 
more than 20%.</span></p>

<p align="justify">
	<i><b>&nbsp;3.2
	Results of PDAs Performance Evaluation</b></i><p class="MsoNormal" style="text-align: justify">
<span lang="EN-US">In order to observe performance of four described PDAs 
utterances pronounced by male and female speakers were selected from SpeechDat 
database. Each utterance consists of ten words (numbers from one to ten) in 
Czech language. Results of PDA performance evaluation are shown in Table 1 and 
Fig. 8</span><span style="font-size: 9.0pt">. </span><span lang="EN-US">Results 
of evaluation&nbsp; of pitch detection algorithms are presented separately for male 
and female speech. In Fig. 8 graphical representation of PDAs performance is 
presented</span><span style="font-size: 9.0pt">.</span> <span lang="EN-US">For 
better view, Fig. 8 presents only part of the utterances used in experiments. It 
should be noted that pitch detection algorithms performed better on utterances 
pronounced by male speakers. As follows from Table 1, the best results among the 
algorithms were achieved by algorithm based on normalized cross-correlation 
function (NCCF). For male speech only 0.72% of voiced frames have the estimated 
F<sub>0</sub> value more than 20% deviation from the reference. NCCF is the best 
in the overall gross errors although it is closely followed by MACF (GE=0.81). 
In addition, MACF algorithm outperforms NCCF in voiced/unvoiced classification 
for male speech. For MACF only 3.07% of voiced frames were misclassified as 
unvoiced and unvoiced frames misclassified as voiced.&nbsp; The CPD algorithm gets 
the good results in pitch estimation for male a female speech (GE=0.79 and 3.02 
respectively). However it fails MACF and NCCF algorithms in voiced/unvoiced 
classification (CE=10.84 and 18.83 for male and female speech respectively). 
Results of our experiments show that AMDF method is the most inaccurate one. It 
has the biggest values of gross error and classification error parameters. 
Problem of pitch multiple and pitch halving is evident for this pitch detection 
algorithm.</span></p>
<p class="MsoNormal" style="text-indent: 14.2pt" align="center">
<span style="font:7.0pt &quot;Times New Roman&quot;" lang="EN-US"></span><i>Table 1. Performance evaluation 
results of different PDAs on clean speech</i></p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021431_Tab1a.png" width="486" height="176" alt="Tab1" title="Tab1" /></div></td>
					</tr>
	</table>
</p>
<table align="center">
		<tr>
			<td align="center"><div align="center"><img src="storage/200906021425_Fig8a.png" width="891" height="889" alt="Fig8" title="Fig8" /></div></td>
					</tr>
	</table>

<p class="Text" align="center"><span lang="EN-US">a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b)</span></p>
<p class="MsoNormal" align="center" style="text-indent: 14.2pt"><i>Figure 8: 
Evaluation of pitch detection algorithms on male (a) and female (b) speech.</i></p>

<h3>4. <span lang="EN-US">Conclusion</span></h3>
<p class="Text"><span lang="EN-US">This paper is focused on pitch detection 
algorithms for speech signals. Four PDAs based on the autocorrelation function, 
the normalized cross-correlation function, the average magnitude difference 
function and cepstral analysis were introduced. Each of the described algorithms 
have their advantages and drawbacks. From the experimental results, the MACF 
method is more convenient for common usage. This algorithm exhibits accurate 
results of pitch estimation and low computational complexity. The NCCF method 
presents the best results in pitch detection accuracy and voiced/unvoiced 
classification, but it is computationally more complex than the MACF. In 
addition, it needs energy calculations for voiced/unvoiced classification. The 
CPD show good pitch estimation accuracy. Fundamental frequency estimation in 
this algorithm is immune to errors due to effects of vocal tract. However, CPD 
method is computationally complex; it needs additional parameters for 
voiced/unvoiced decision. The AMDF method has great advantage in very low 
computational complexity, it possible to implement it in real-time applications. 
However this algorithm showed poor results in accuracy of pitch estimation and 
pattern recognition. </span></p>

<h3 align="center"><span lang="EN-US" style="font-weight: 400">Acknowledgements</span></h3>
<p class="Text"><span lang="EN-US">This paper has originated thanks to the 
support from the Ministry of Education, Youth and Sports of Czech Republic 
within the project MSM6840770014.</span></p>
<p class="ReferenceHead" align="center"><span lang="EN-US"><font size="4">References</font></span></p>
<p class="ReferenceHead" align="left">[1] A. M. Kondoz , &quot;Digital speech: Coding 
for low bit rate communication systems&quot;, 2nd Edn, John Wiley&amp;Sons, England, 
2004.<br>
[2] W. J. Hess, Pitch Determination of Speech Signals. New York: Springer, 1993.<br>
[3] D. Talkin, “A robust algorithm for pitch tracking (RAPT)”.Speech Coding and 
Synthesis, Elsevier Science, Amsterdam, pp.495-518,1995.<br>
[4] M. J. Ross, H. L. Shaffer, A. Cohen, R. Freudberg, and H. J. Manley, 
“Average magnitude difference function pitch extractor,” vol.ASSP-22, no. 5, pp. 
353–362, Oct. 1974.<br>
[5] A. M. Noll, &quot;Cepstrum Pitch Determination&quot;, Journal of the Acoustical 
Society of America, Vol. 41, No. 2, pp. 293-309, 1967<br>
[6] L. Rabiner, M. J. Cheng, A. E. Rosenberg, and C. A. McGonegal, &quot;A 
comparative performance study of several pitch detection algorithms,&quot; IEEE 
Transactions on ASSP, vol. 24, pp. 399-417, 1976.<br>
[7] H. Bo&#345;il, P. Pollák,&nbsp;&quot;Direct Time Domain Fundamental Frequency Estimation of 
Speech in Noisy Conditions&quot;. Proc. EUSIPCO2004, Wien, Austria, vol.&nbsp;1, 
p.&nbsp;1003-1006, 2004.<br>
[8] B. Kotnik, H. Höge, and Z. Kacic, “Evaluation of Pitch Detection Algorithms 
in Adverse Conditions”. Proc. 3rd International Conference on Speech Prosody, 
Dresden, Germany,pp. 149-152, 2006<font size="4"><span lang="en-us">.</span></font></p>
</div><br />
<br />
Autor:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="mailto:vertee1(at)fel.cvut.cz">E. Verteletskaya, B. Šimák</a>
<br />
Pracoviště:&nbsp;<a href="http://www.comtel.cz">České vysoké učení technické v Praze, FEL</a>
<br /><br />
<a href="rservice.php?akce=info&amp;cisloclanku=2009060001" target="_blank"><img src="vzhled/mail.gif" height="22" width="20" border="0" hspace="0" vspace="0" align="top" alt="Informační e-mail" /></a> <a href="rservice.php?akce=tisk&amp;cisloclanku=2009060001" target="_blank"><img src="vzhled/printer.gif" height="22" width="20" border="0" hspace="0" vspace="0" align="top" alt="Vytisknout článek" /></a>
</div>
</div>
</td>
<td align="center" valign="top" width="180"><!-- start - blok -->
<div class="blok-hlava">Projekty a aktuality</div>
<div class="blok-telo_blok_2"><span class="nov-datum">01.03.2012:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Výzkum a vývoj nového komunikačního systému s vícekanálovým přístupem a mezivrstvovou spoluprací pro průmyslové aplikace <a href="http://access.feld.cvut.cz/view.php?cisloclanku=2012030001"> TA02011015</a>

</div>
<br />
<span class="nov-datum">01.01.2012:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Vývoj adaptabilních datových a procesních systémů pro vysokorychlostní, bezpečnou a spolehlivou komunikaci v extrémních podmínkách <a href="http://access.feld.cvut.cz/view.php?cisloclanku=2012050002"> VG20122014095</a></div>
<br />
<span class="nov-datum">09.10.2010:</span> <span class="nov-titulek">PROJEKT </span><div class="nov-text">Výzkum a vývoj datového modulu 10 Gbit/s pro optické a mikrovlnné bezdrátové spoje, FR-TI2/621</div>
<br />
<span class="nov-datum">09.01.2010:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Sítě s femtobuňkami rozšířené o řízení interference a koordinaci informací pro bezproblémovou konektivitu, FP7-ICT-2009-4 248891</div>
<br />
<span class="nov-datum">09.11.2008:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Ochrana člověka a techniky před vysokofrekvenčním zářením, FI-IM5/202</div>
<br />
<span class="nov-datum">20.06.2008:</span> <span class="nov-titulek-duraz">Schválení</span><div class="nov-text">Radou pro výzkum a vývoj jako recenzovaný časopis</div>
<br />
<span class="nov-datum">01.04.2007:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Pokročilá optimalizace návrhu komunikačních systémů pomocí neuronových sítí, GA102/07/1503</div>
<br />
<span class="nov-datum">01.07.2006:</span> <span class="nov-titulek">Doplnění sekce pro registrované</span><div class="nov-text"></div>
<br />
<span class="nov-datum">12.04.2005:</span> <span class="nov-titulek">Zavedeno recenzování článků</span><div class="nov-text"></div>
<br />
<span class="nov-datum">30.03.2005:</span> <span class="nov-titulek">Výzkumný záměr</span><div class="nov-text">Výzkum perspektivních informačních a komunikačních technologií MSM6840770014</div>
<br />
<span class="nov-datum">29.11.2004:</span> <span class="nov-titulek">Přiděleno ISSN</span><div class="nov-text"></div>
<br />
<span class="nov-datum">04.11.2004:</span> <span class="nov-titulek">Spuštění nové podoby Access serveru</span><div class="nov-text"></div>
<br />
<span class="nov-datum">18.10.2004:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Optimalizace přenosu dat rychlostí 10 Gbit/s, <a href="http://access.feld.cvut.cz/view.php?cisloclanku=2005041801">GA102/04/0773</a></div>
<br />
<span class="nov-datum">04.09.2004:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Specifikace kvalitativních kritérií a optimalizace prostředků pro vysokorychlostní přístupové sítě, <a href="view.php?cisloclanku=2004090401">NPV 1ET300750402</a></div>
<br />
<span class="nov-datum">04.06.2004:</span> <span class="nov-titulek">PROJEKT</span><div class="nov-text">Omezující faktory při širokopásmovém přenosu signálu po metalických párech a vzájemná koexistence s dalšími systémy, <a href="view.php?cisloclanku=2004060401">GA102/03/0434</a></div>
</div>
<!-- konec - blok -->
<br />
</td>
</tr>
</table>

<div class="zapati">



<p class="z">
<a href="http://www.supersvet.cz/phprs/" target="_blank"><img src="vzhled/plogo_phprs.gif" alt="Web site powered by phpRS" border="0" hspace="10" height="31" width="88" /></a>
<a href="http://www.php.net" target="_blank"><img src="vzhled/plogo_php.gif" alt="PHP Scripting Language" border="0" hspace="10" height="31" width="88" /></a>
<a href="http://www.mysql.com" target=blank><img src="vzhled/plogo_mysql.gif" alt="MySQL" border="0" hspace="10" height="31" width="88" /></a>
<a href="http://www.apache.org" target=blank><img src="vzhled/plogo_apache.gif" alt="Apache Web Server" border="0" hspace="10" height="31" width="88" /></a>
</p>

<p align="center">
<script src="http://c1.navrcholu.cz/code?site=88992;t=o80" type="text/javascript"></script>
<noscript><div><a href="http://navrcholu.cz/">
<img src="http://c1.navrcholu.cz/hit?site=88992;t=o80;ref=;jss=0" width="80" height="15" alt="NAVRCHOLU.cz" style="border:none" /></a></div>
</noscript>
</p>

<p class="z">
Tento web site byl vytvořen prostřednictvím <a href="http://www.supersvet.cz/phprs/" target="_blank">phpRS</a> - redakčního systému napsaného v PHP jazyce.<br />
Na této stránce použité názvy programových produktů, firem apod. mohou být ochrannými známkami<br />
nebo registrovanými ochrannými známkami příslušných vlastníků.
</p>

</div>

</body>
</html>